---
excludes:
  - "**/tmp"

processors:
  - name: "gofmt"
    tags:
      - code
    includes:
      - "**/*.go"
    check:
      template: "gofmt -d"
      input: variadic
      output: stdout
      format: none
    # fix:
    #   template: "gofmt -w"
    #   input: variadic
    #   output: none
    # editor_config: true
    # check_before_fix: true

  - name: "golangci-lint"
    tags:
      - code
    includes:
      - "**/*.go"
    check:
      template: "golangci-lint run --out-format=json"
      input: none
      output: stdout
      format: json
      mapping:
        pattern: "Issues"
        level: '{{ .Severity | default "error" }}'
        path: "{{ .Pos.Filename }}"
        start_line: "{{ .Pos.Line }}"
        start_column: "{{ .Pos.Column }}"
        end_line: "-1"
        end_column: "-1"
        rule_id: "{{ .FromLinter }}"
        rule_name: "{{ .FromLinter }}"
        rule_description: "{{ .Text }}"
        rule_uri: "https://golangci-lint.run/usage/linters/#{{ .FromLinter }}"
        context: '{{ if .SourceLines }}{{ join "\n" .SourceLines }}{{ end }}'

  - name: "markdownlint"
    tags:
      - docs
    includes:
      - "**/*.md"
    check:
      template: "markdownlint --json"
      input: variadic # stdin, arg, variadic
      output: stderr # stdout, stderr
      format: json
      mapping:
        level: "error"
        path: "{{ .fileName }}"
        start_line: "{{ .lineNumber }}"
        start_column: "{{ if .errorRange }}{{ index .errorRange 0 }}{{ end }}"
        end_line: "{{ .lineNumber }}"
        end_column: "{{ if .errorRange }}{{ add (index .errorRange 0) (index .errorRange 1) }}{{ end }}"
        rule_id: "{{ index .ruleNames 0 }}"
        rule_name: "{{ index .ruleNames 1 }}"
        rule_description: "{{ .ruleDescription }} {{ if .errorDetail }}[{{ .errorDetail }}]{{ end }}"
        rule_uri: "{{ .ruleInformation }}"
    # fix:
    #   template: "markdownlint --fix"
    #   input: variadic
    #   output: none

  # - name: "shellcheck"
  #   includes:
  #     - "**/*.sh"

  # - name: "yamllint"
  #   includes:
  #     - "**/*.{yaml,yml}"
  #   excludes:
  #     - "**/secrets.yaml"
